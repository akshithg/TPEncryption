<!DOCTYPE html>
<!-- saved from url=(0019)http://camanjs.com/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>TPEncryption - Image Encryption Tool</title>

    <script type="text/javascript" src="static/js/jquery.min.js"></script>
    <!--<script type="text/javascript" src="https://rawgit.com/ricmoo/aes-js/master/index.js"></script>-->
    <script type="text/javascript" src="static/js/tpencryption.js"></script>
    <script type="text/javascript" src="static/js/aejs.js"></script>

    <script type="text/javascript" src="static/js/site.js"></script>
    <link rel="stylesheet" href="static/css/fonts.css" type="text/css">
    <link rel="stylesheet" href="static/css/site.css" type="text/css">

</head>
<body>
<div id="HeaderContainer">
    <div id="Header">
        <div class="Left">
            <h1 style="display: inline">TPEncryption</h1>
        </div>
        <div class="Right">
            <ul>
                <li class="Active">
                    <a href="./">Home</a>
                </li>
                <li>
                    <a href="./usage.html">Usage</a>
                </li>
                <li>
                    <a href="./desc.html">Description</a>
                </li>
            </ul>
        </div>
        <div class="Clear"></div>
    </div>
</div>

<div id="Content">

    <h3>What is TPEncryption?</h3>

    <p>TPEncryption is a tool for <i>encrypting your images using a thumbnail preserving algorithm</i> which is completely described <a href="./desc.html">here</a>.</p>
    <p>TPEncryption could be used using the <b>TPEncryption browser plugin</b> which is available for Google Chrome and also <b>TPEncryption javascript library</b> which is open source and suitable for web developers.</p>

    <br/>
    <h3 style="display: inline;">Demo</h3>
    <span style="font-size: 11px;margin-left: 10px;color:royalblue;cursor: pointer;" onclick="loadDemo();"><u>sample image</u></span>
    <span style="font-size: 11px;float: right;margin-top: 8px;margin-right: 28px;" id="status"></span>
    <center>
        <div class="HomeLinks">
            <div class="LinksSection" style="display: inline;margin:0 0 0 5px;">
                <input type="number" id="iter" placeholder="#iterations = 10" min="1" max="100" style="height:10px;width: 86px;border:1px solid darkgray;border-radius: 3px;text-align: center;padding: 10px 10px;margin: 10px 0;display: inline;"/>
            </div>
            <div class="LinksSection" style="display: inline;">
                <input type="number" id="block-size" placeholder="block-size = 25" min="1" max="500" style="height:10px;width: 86px;border:1px solid darkgray;border-radius: 3px;text-align: center;padding: 10px 10px;margin: 10px 0;display: inline;"/>
            </div>
            <div class="LinksSection" style="width: 86px;display: inline-block;">
                <a href="#" onclick="encrypt();return false;" id="encrypt-btn" style="background-color: #666666;cursor:not-allowed;font-size: 11px;padding: 10px 0;">Encrypt</a>
            </div>
            <div class="LinksSection" style="width: 86px;display: inline-block;">
                <a href="#" onclick="decrypt();return false;" id="decrypt-btn" style="background-color: #666666;cursor:not-allowed;font-size: 11px;padding: 10px 0;">Decrypt</a>
            </div>
            <div class="LinksSection" style="width: 86px;display: inline-block;">
                <a href="#" id="thumbLink" onclick="showThumbs();return false;" style="background-color: #666666;cursor:not-allowed;font-size: 11px;padding: 10px 0;">Thumbnails</a>
            </div>
            <div class="LinksSection" style="width: 86px;display: inline-block;">
                <a href="#" id="downloadLink"  download="encrypted.png" style="background-color: #666666;cursor:not-allowed;font-size: 11px;padding: 10px 0;">Download</a>
            </div>


            <br/>
            <br/>
            <canvas id="input-canvas" width="250" height="250" style="border: 1px dashed darkgray;width: 45%;">I am canvas</canvas>
            <canvas id="output-canvas" width="250" height="250" style="border: 1px dashed darkgray;width: 45%;">I am canvas</canvas>

            <div class="Clear"></div>
        </div>
    </center>

    <br>

    <!--<h3>Usage</h3>-->
    <!--&lt;!&ndash;<p>Javascript</p>&ndash;&gt;-->
    <!--<div class="highlight"><pre><code class="js" style="margin-left: 20px;display: block;">-->
          <!--<span class="kd">var</span><span class="nx"> x</span><span class="p"> = </span><span class="kd">new</span><span class="nx"> TPEncryption</span><span class="p">(</span><span class="s1">'#my-image'</span><span class="p">)</span><span class="p">;</span>-->
          <!--<span class="nx">x</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s1">num_of_iterations</span> <span class="p">, </span><span class="s1">block_size</span><span class="p">, </span><span class="kd">function</span> <span class="p">(key)</span> <span class="p">{</span>-->
          <!--<span class="p">    </span><span class="cm">// tasks to be executed after enycrption.</span>-->
          <!--<span class="p">});</span></code></pre>-->
        <!--</code></pre></div>-->
    <!--<br/>-->


    <!--<h3>Download</h3>-->

    <!--<div class="HomeLinks">-->

        <!--<div class="LinksSection" style="margin-left:80px;">-->
            <!--<a href="#" style="font-size: 13px;">Latest Library</a>-->
        <!--</div>-->

        <!--<div class="LinksSection">-->
            <!--<a href="./static/plugin.crx" style="font-size: 13px;">Chrome Plugin</a>-->
        <!--</div>-->

        <!--<div class="Clear"></div>-->
    <!--</div>-->

    <!--<h3>Contribute</h3>-->
<!---->
    <!--<p><a href="#">TPEncryption</a> is fully open-source and accepting pull requests. To contribute: fork either project, create a new branch for your changes, and send a pull request when ready.</p>-->

    <script type="text/javascript">
        (function () {
            var canvas = document.getElementById("input-canvas"),
                    context = canvas.getContext("2d"),
                    img = document.createElement("img"),
                    mouseDown = false,
                    brushColor = "rgb(0, 0, 0)",
                    hasText = true,
                    clearCanvas = function () {
                        if (hasText) {
                            context.clearRect(0, 0, canvas.width, canvas.height);
                            hasText = false;
                        }
                    };

            // Adding instructions
            context.font = "12px 'Raleway'";
            context.fillText("drop an image here", 70, canvas.height/2-10);
            context.fillText("or use sample-image", 65, canvas.height/2+10);

            // Image for loading
            img.addEventListener("load", function () {
                clearCanvas();
                context.drawImage(img, 0, 0, img.width, img.height);
            }, false);


            // To enable drag and drop
            canvas.addEventListener("dragover", function (evt) {
                evt.preventDefault();
            }, false);

            // Handle dropped image file - only Firefox and Google Chrome
            canvas.addEventListener("drop", function (evt) {
                var files = evt.dataTransfer.files;
                if (files.length > 0) {
                    var file = files[0];
                    if (typeof FileReader !== "undefined" && file.type.indexOf("image") != -1) {
                        var reader = new FileReader();
                        // Note: addEventListener doesn't work in Google Chrome for this event
                        reader.onload = function (evt) {

                            img.src = evt.target.result;
                            canvas.width = img.width;
                            canvas.height = img.height;

                            var c2=document.getElementById("output-canvas");
                            var ctx2=c2.getContext('2d');
                            ctx2.clearRect(0, 0, canvas.width, canvas.height);

                            c2.width = img.width;
                            c2.height = img.height;

                            imgWidth = img.width;
                            imgHeight = img.height;

                            enableEncryptButton();
                            encrypted = false;
                            disableDownloadtButton();
                        };
                        reader.readAsDataURL(file);
                    }
                }
                evt.preventDefault();
            }, false);

        })();

    </script>
    <script type="text/javascript">
        var tPEncryption;
        var disabled = true;
        var encrypted = false;
        var isEncrypting = false;
        var imgWidth = 500;
        var imgHeight = 500;

        var encrypt = function() {
            if (!disabled) {
                var c=document.getElementById("input-canvas");
                var ctx=c.getContext("2d");
                var c2=document.getElementById("output-canvas");
                var ctx2=c2.getContext('2d');
                tPEncryption = new TPEncryption("output-canvas", "Example128BitKey");
                var e = document.getElementById('block-size');
                var size = e.value;
                if (!size)
                    size = 25;
                else
                    size = parseInt(size);
                var e = document.getElementById('iter');
                var iter = e.value;
                if (!iter)
                    iter = 10;
                else
                    iter = parseInt(iter);
                var d = document.getElementById("status");
                d.innerHTML = "estimated run-time: " + (iter * c.width * c.height * 100 / 250000) + " ms";
                setTimeout(function () {
                    ctx2.putImageData(ctx.getImageData(0, 0, c.width, c.height), 0, 0);
                    tPEncryption.encrypt(iter, size, function (time) {
                        enableDownloadtButton();
                        encrypted = true;
                        var d = document.getElementById("status");
                        d.innerHTML = "rune-time: " + (time) + " ms";
                    });
                }, 100);
            } else {
            }
        };

        var decrypt = function() {
            if (!disabled) {
                var c=document.getElementById("input-canvas");
                var ctx=c.getContext("2d");
                var c2=document.getElementById("output-canvas");
                var ctx2=c2.getContext('2d');
                tPEncryption = new TPEncryption("output-canvas", "Example128BitKey");
                var e = document.getElementById('block-size');
                var size = e.value;
                if (!size)
                    size = 25;
                else
                    size = parseInt(size);
                var e = document.getElementById('iter');
                var iter = e.value;
                if (!iter)
                    iter = 10;
                else
                    iter = parseInt(iter);
                var d = document.getElementById("status");
                d.innerHTML = "estimated run-time: " + (iter * c.width * c.height * 100 / 250000) + " ms";
                setTimeout(function () {
                    ctx2.putImageData(ctx.getImageData(0, 0, c.width, c.height), 0, 0);
                    tPEncryption.decrypt(iter, size, function(time) {
                        enableDownloadtButton();
                        encrypted = true;
                        var d = document.getElementById("status");
                        d.innerHTML = "rune-time: " + (time) + " ms";
                    });
                }, 100);
            } else {
            }
        };
        var loadDemo = function() {
            var c=document.getElementById("peopleImg");
            var c2=document.getElementById("input-canvas");
            c2.width = 500;
            c2.height = 500;
            var ctx2=c2.getContext('2d');
            ctx2.drawImage(c, 0, 0, 500, 500);

            var c2=document.getElementById("output-canvas");
            var ctx2=c2.getContext('2d');
//            ctx2.clearRect(0, 0, c2.width, c2.height);
            c2.width = 500;
            c2.height = 500;

            enableEncryptButton();
            encrypted = false;
            disableDownloadtButton();
        };

        var enableEncryptButton = function () {
            if (disabled) {
                disabled = false;
                var x= document.getElementById("encrypt-btn");
                x.style.backgroundColor = "#368ad2";
                x.style.cursor = "pointer";
                var x= document.getElementById("decrypt-btn");
                x.style.backgroundColor = "#368ad2";
                x.style.cursor = "pointer";
            }
        };

        var enableDownloadtButton = function () {
            var x= document.getElementById("downloadLink");
            x.style.backgroundColor = "#368ad2";
            x.style.cursor = "pointer";

            var x= document.getElementById("thumbLink");
            x.style.backgroundColor = "#368ad2";
            x.style.cursor = "pointer";

        };

        var disableDownloadtButton = function () {
            var x= document.getElementById("downloadLink");
            x.style.backgroundColor = "#666666";
            x.style.cursor = "not-allowed";
            var x= document.getElementById("thumbLink");
            x.style.backgroundColor = "#666666";
            x.style.cursor = "not-allowed";
        };

        var save = function() {
            if (encrypted) {
                var x= document.getElementById("output-canvas");
                var dt = x.toDataURL('image/png');
                this.href = dt;
            } else {
            }
        };
        downloadLink.addEventListener('click', save, false);

        var showThumbs = function() {
            if (encrypted) {
                tPEncryption.thumb();
                var y2 = new TPEncryption("input-canvas", "Example128BitKey");
                y2.block_size = tPEncryption.block_size;
                y2.thumb();
            }
        }




    </script>

    <img src="static/imgs/people_500.jpg" id="peopleImg" style="display: none;">
</div>

</body></html>
